{"ast":null,"code":"var _jsxFileName = \"/home/antoniopedropi/ses-group4/frontend/src/pages/StudentPage.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { AuthContext } from '../AuthContext';\nimport { Link } from 'react-router-dom';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StudentPage = () => {\n  _s();\n  const [courses, setCourses] = useState([]);\n  const {\n    user,\n    setUser\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const checkAuth = () => {\n      const userRole = \"\";\n      const token = localStorage.getItem('token');\n      if (token) {\n        axios.get('http://localhost:8000/users/me', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        }).then(res => {\n          setUser(res.data);\n          userRole = res.data.role;\n          console.log(\"userRole: \", res.data.role);\n        }).catch(err => {\n          console.error('Error fetching user data:', err);\n          toast.error('Failed to fetch user data.');\n        });\n      }\n      if (!token) {\n        navigate('/login');\n      } else {\n        const allowedRoles = ['student'];\n        if (userRole != \"\") {\n          if (!allowedRoles.includes(userRole)) {\n            navigate('/login');\n          }\n        }\n      }\n    };\n    checkAuth();\n  }, [navigate]);\n  useEffect(() => {\n    axios.get('http://localhost:8000/users/me/courses', {\n      headers: {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    }).then(response => {\n      setCourses(response.data);\n    }).catch(error => {\n      console.error('There was an error fetching the courses!', error);\n    });\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"My Courses\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"list-group\",\n      children: courses.map(course => /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"list-group-item\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: `/courses/${course.id}`,\n          children: course.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this)\n      }, course.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(StudentPage, \"Sm41lR4Hii0qjyeTh/174rp8xdQ=\", false, function () {\n  return [useNavigate];\n});\n_c = StudentPage;\nexport default StudentPage;\nvar _c;\n$RefreshReg$(_c, \"StudentPage\");","map":{"version":3,"names":["React","useContext","useEffect","useState","axios","AuthContext","Link","useNavigate","toast","jsxDEV","_jsxDEV","StudentPage","_s","courses","setCourses","user","setUser","navigate","checkAuth","userRole","token","localStorage","getItem","get","headers","then","res","data","role","console","log","catch","err","error","allowedRoles","includes","response","children","fileName","_jsxFileName","lineNumber","columnNumber","className","map","course","to","id","title","_c","$RefreshReg$"],"sources":["/home/antoniopedropi/ses-group4/frontend/src/pages/StudentPage.js"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport axios from 'axios';\nimport {AuthContext} from '../AuthContext';\nimport {Link} from 'react-router-dom';\nimport {useNavigate} from 'react-router-dom';\nimport {toast} from \"react-toastify\";\n\nconst StudentPage = () => {\n  const [courses, setCourses] = useState([]);\n  const { user,setUser } = useContext(AuthContext);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const checkAuth = () => {\n      const userRole =\"\"\n      const token = localStorage.getItem('token');\n      if(token){axios.get('http://localhost:8000/users/me', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        })\n        .then(res => {\n          setUser(res.data);\n          userRole = res.data.role\n          console.log(\"userRole: \", res.data.role);\n          })\n        .catch(err => {\n          console.error('Error fetching user data:', err);\n          toast.error('Failed to fetch user data.');\n        });}\n      if (!token) {\n        navigate('/login');\n      } else {\n        const allowedRoles = ['student'];\n\n        if(userRole!=\"\"){if (!allowedRoles.includes(userRole)) {\n          navigate('/login');\n        }}\n      }\n    }\n    checkAuth();\n  }, [navigate]);\n\n  useEffect(() => {\n    axios.get('http://localhost:8000/users/me/courses', {\n      headers: {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    })\n    .then(response => {\n      setCourses(response.data);\n    })\n    .catch(error => {\n      console.error('There was an error fetching the courses!', error);\n    });\n  }, [user]);\n\n  return (\n    <div>\n      <h2>My Courses</h2>\n      <ul className=\"list-group\">\n        {courses.map(course => (\n          <li key={course.id} className=\"list-group-item\">\n            <Link to={`/courses/${course.id}`}>{course.title}</Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default StudentPage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAC5D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAQC,WAAW,QAAO,gBAAgB;AAC1C,SAAQC,IAAI,QAAO,kBAAkB;AACrC,SAAQC,WAAW,QAAO,kBAAkB;AAC5C,SAAQC,KAAK,QAAO,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErC,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACxB,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM;IAAEY,IAAI;IAACC;EAAQ,CAAC,GAAGf,UAAU,CAACI,WAAW,CAAC;EAChD,MAAMY,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAE9BL,SAAS,CAAC,MAAM;IACd,MAAMgB,SAAS,GAAGA,CAAA,KAAM;MACtB,MAAMC,QAAQ,GAAE,EAAE;MAClB,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAGF,KAAK,EAAC;QAAChB,KAAK,CAACmB,GAAG,CAAC,gCAAgC,EAAE;UAClDC,OAAO,EAAE;YACP,eAAe,EAAG,UAASJ,KAAM;UACnC;QACF,CAAC,CAAC,CACDK,IAAI,CAACC,GAAG,IAAI;UACXV,OAAO,CAACU,GAAG,CAACC,IAAI,CAAC;UACjBR,QAAQ,GAAGO,GAAG,CAACC,IAAI,CAACC,IAAI;UACxBC,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEJ,GAAG,CAACC,IAAI,CAACC,IAAI,CAAC;QACxC,CAAC,CAAC,CACHG,KAAK,CAACC,GAAG,IAAI;UACZH,OAAO,CAACI,KAAK,CAAC,2BAA2B,EAAED,GAAG,CAAC;UAC/CxB,KAAK,CAACyB,KAAK,CAAC,4BAA4B,CAAC;QAC3C,CAAC,CAAC;MAAC;MACL,IAAI,CAACb,KAAK,EAAE;QACVH,QAAQ,CAAC,QAAQ,CAAC;MACpB,CAAC,MAAM;QACL,MAAMiB,YAAY,GAAG,CAAC,SAAS,CAAC;QAEhC,IAAGf,QAAQ,IAAE,EAAE,EAAC;UAAC,IAAI,CAACe,YAAY,CAACC,QAAQ,CAAChB,QAAQ,CAAC,EAAE;YACrDF,QAAQ,CAAC,QAAQ,CAAC;UACpB;QAAC;MACH;IACF,CAAC;IACDC,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,CAACD,QAAQ,CAAC,CAAC;EAEdf,SAAS,CAAC,MAAM;IACdE,KAAK,CAACmB,GAAG,CAAC,wCAAwC,EAAE;MAClDC,OAAO,EAAE;QACP,eAAe,EAAG,UAASH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE;MAC3D;IACF,CAAC,CAAC,CACDG,IAAI,CAACW,QAAQ,IAAI;MAChBtB,UAAU,CAACsB,QAAQ,CAACT,IAAI,CAAC;IAC3B,CAAC,CAAC,CACDI,KAAK,CAACE,KAAK,IAAI;MACdJ,OAAO,CAACI,KAAK,CAAC,0CAA0C,EAAEA,KAAK,CAAC;IAClE,CAAC,CAAC;EACJ,CAAC,EAAE,CAAClB,IAAI,CAAC,CAAC;EAEV,oBACEL,OAAA;IAAA2B,QAAA,gBACE3B,OAAA;MAAA2B,QAAA,EAAI;IAAU;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACnB/B,OAAA;MAAIgC,SAAS,EAAC,YAAY;MAAAL,QAAA,EACvBxB,OAAO,CAAC8B,GAAG,CAACC,MAAM,iBACjBlC,OAAA;QAAoBgC,SAAS,EAAC,iBAAiB;QAAAL,QAAA,eAC7C3B,OAAA,CAACJ,IAAI;UAACuC,EAAE,EAAG,YAAWD,MAAM,CAACE,EAAG,EAAE;UAAAT,QAAA,EAAEO,MAAM,CAACG;QAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO;MAAC,GADjDG,MAAM,CAACE,EAAE;QAAAR,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAEd,CACL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACF,CAAC;AAEV,CAAC;AAAC7B,EAAA,CA9DID,WAAW;EAAA,QAGEJ,WAAW;AAAA;AAAAyC,EAAA,GAHxBrC,WAAW;AAgEjB,eAAeA,WAAW;AAAC,IAAAqC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}